<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Reaction Wheel Assembly: Driver Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Reaction Wheel Assembly<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A 1DoF prototype for speed control of a frictionless momentum exchange device using a brushless DC motor.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('class_driver.html','','class_driver-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Driver Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_driver_8h_source.html">Driver.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af441586aaf1e40c53a08aecfda452224" id="r_af441586aaf1e40c53a08aecfda452224"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af441586aaf1e40c53a08aecfda452224">Driver</a> (void)</td></tr>
<tr class="memdesc:af441586aaf1e40c53a08aecfda452224"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for the <a class="el" href="class_driver.html">Driver</a> class.  <br /></td></tr>
<tr class="memitem:a65c3a4ff39eb08b1cd8e91e298bc3ddd" id="r_a65c3a4ff39eb08b1cd8e91e298bc3ddd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65c3a4ff39eb08b1cd8e91e298bc3ddd">Driver</a> (uint8_t FILK1_, uint8_t FILK2_, uint8_t COMPK1_, uint8_t COMPK2_)</td></tr>
<tr class="memdesc:a65c3a4ff39eb08b1cd8e91e298bc3ddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for the <a class="el" href="class_driver.html">Driver</a> class.  <br /></td></tr>
<tr class="memitem:aaf271624499126d5fe201d85b1685aeb" id="r_aaf271624499126d5fe201d85b1685aeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf271624499126d5fe201d85b1685aeb">begin</a> (void)</td></tr>
<tr class="memdesc:aaf271624499126d5fe201d85b1685aeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which initializes the DRV8308.  <br /></td></tr>
<tr class="memitem:a9424d9649c05cc33a61e74d4f7bc438a" id="r_a9424d9649c05cc33a61e74d4f7bc438a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9424d9649c05cc33a61e74d4f7bc438a">scs_begin</a> (void)</td></tr>
<tr class="memdesc:a9424d9649c05cc33a61e74d4f7bc438a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the chip select pin to HIGH.  <br /></td></tr>
<tr class="memitem:a02225bf32d39bbb7deff11f11eeb2090" id="r_a02225bf32d39bbb7deff11f11eeb2090"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02225bf32d39bbb7deff11f11eeb2090">scs_end</a> (void)</td></tr>
<tr class="memdesc:a02225bf32d39bbb7deff11f11eeb2090"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the chip select pin to LOW.  <br /></td></tr>
<tr class="memitem:a3ce3987ee4355a9b9e8a0aa7ee659874" id="r_a3ce3987ee4355a9b9e8a0aa7ee659874"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ce3987ee4355a9b9e8a0aa7ee659874">enable</a> (void)</td></tr>
<tr class="memdesc:a3ce3987ee4355a9b9e8a0aa7ee659874"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the enable pin to HIGH.  <br /></td></tr>
<tr class="memitem:a455b301fd7e229291c87dd3873e8b6ea" id="r_a455b301fd7e229291c87dd3873e8b6ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a455b301fd7e229291c87dd3873e8b6ea">disable</a> (void)</td></tr>
<tr class="memdesc:a455b301fd7e229291c87dd3873e8b6ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the enable pin to LOW.  <br /></td></tr>
<tr class="memitem:a8dce7a48c374e73ca61327fd2d24bc3c" id="r_a8dce7a48c374e73ca61327fd2d24bc3c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8dce7a48c374e73ca61327fd2d24bc3c">brake</a> (void)</td></tr>
<tr class="memdesc:a8dce7a48c374e73ca61327fd2d24bc3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the brake pin to HIGH.  <br /></td></tr>
<tr class="memitem:a85c6803836ce05696221267c55150676" id="r_a85c6803836ce05696221267c55150676"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85c6803836ce05696221267c55150676">unbrake</a> (void)</td></tr>
<tr class="memdesc:a85c6803836ce05696221267c55150676"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the brake pin to LOW.  <br /></td></tr>
<tr class="memitem:a1f99f1d96fa20feee9311d46084725ff" id="r_a1f99f1d96fa20feee9311d46084725ff"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f99f1d96fa20feee9311d46084725ff">get_dir</a> (void)</td></tr>
<tr class="memdesc:a1f99f1d96fa20feee9311d46084725ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which reads the direction.  <br /></td></tr>
<tr class="memitem:a7758fb8433f9eb70c246f3bd347a9a5f" id="r_a7758fb8433f9eb70c246f3bd347a9a5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7758fb8433f9eb70c246f3bd347a9a5f">set_dir</a> (bool direction)</td></tr>
<tr class="memdesc:a7758fb8433f9eb70c246f3bd347a9a5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which sets the direction.  <br /></td></tr>
<tr class="memitem:a17af9704f964721863b46977850ccd6a" id="r_a17af9704f964721863b46977850ccd6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17af9704f964721863b46977850ccd6a">drv_write</a> (uint8_t spdmode, uint16_t message)</td></tr>
<tr class="memdesc:a17af9704f964721863b46977850ccd6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which writes a register on the DRV8308.  <br /></td></tr>
<tr class="memitem:a7d9a49ab333a9061275a4fd2d11767ea" id="r_a7d9a49ab333a9061275a4fd2d11767ea"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d9a49ab333a9061275a4fd2d11767ea">drv_read</a> (uint8_t addr7)</td></tr>
<tr class="memdesc:a7d9a49ab333a9061275a4fd2d11767ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which reads a register on the DRV8308.  <br /></td></tr>
<tr class="memitem:a9242027ce038a7794b3fa668550758b6" id="r_a9242027ce038a7794b3fa668550758b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9242027ce038a7794b3fa668550758b6">cmd_speed_PWM</a> (float SPEED_CMD)</td></tr>
<tr class="memdesc:a9242027ce038a7794b3fa668550758b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function which commands a square wave to the CLKIN pin.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pro-methods" class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a13f2394e6a4df6dd62d120c1c2b55a56" id="r_a13f2394e6a4df6dd62d120c1c2b55a56"><td class="memItemLeft" align="right" valign="top"><a id="a13f2394e6a4df6dd62d120c1c2b55a56" name="a13f2394e6a4df6dd62d120c1c2b55a56"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>handleISR</b> ()</td></tr>
<tr class="memdesc:a13f2394e6a4df6dd62d120c1c2b55a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">an ISR handler which puts the timestamp at which the function is called into the edge_time queue. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pro-static-methods" class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a4fc42484ce1216f44b22ddc188a4ec01" id="r_a4fc42484ce1216f44b22ddc188a4ec01"><td class="memItemLeft" align="right" valign="top"><a id="a4fc42484ce1216f44b22ddc188a4ec01" name="a4fc42484ce1216f44b22ddc188a4ec01"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>ISR_wrapper</b> ()</td></tr>
<tr class="memdesc:a4fc42484ce1216f44b22ddc188a4ec01"><td class="mdescLeft">&#160;</td><td class="mdescRight">An ISR wrapper function which calls a different function once the ISR is triggered. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pro-attribs" class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aa2312d952a968f8c4b7b86ab0f5ca213" id="r_aa2312d952a968f8c4b7b86ab0f5ca213"><td class="memItemLeft" align="right" valign="top"><a id="aa2312d952a968f8c4b7b86ab0f5ca213" name="aa2312d952a968f8c4b7b86ab0f5ca213"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>data16</b></td></tr>
<tr class="memitem:a31af4f682eac835e59c8f29a33b4937c" id="r_a31af4f682eac835e59c8f29a33b4937c"><td class="memItemLeft" align="right" valign="top"><a id="a31af4f682eac835e59c8f29a33b4937c" name="a31af4f682eac835e59c8f29a33b4937c"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>msb</b></td></tr>
<tr class="memitem:a6bcd386576bea5df64b28d626cdbd088" id="r_a6bcd386576bea5df64b28d626cdbd088"><td class="memItemLeft" align="right" valign="top"><a id="a6bcd386576bea5df64b28d626cdbd088" name="a6bcd386576bea5df64b28d626cdbd088"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>lsb</b></td></tr>
<tr class="memitem:aa60928425cd04f0f3b79b5cc29a07f14" id="r_aa60928425cd04f0f3b79b5cc29a07f14"><td class="memItemLeft" align="right" valign="top"><a id="aa60928425cd04f0f3b79b5cc29a07f14" name="aa60928425cd04f0f3b79b5cc29a07f14"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_SCLK</b></td></tr>
<tr class="memitem:a9934d97443c229a0c3ad5b697179e641" id="r_a9934d97443c229a0c3ad5b697179e641"><td class="memItemLeft" align="right" valign="top"><a id="a9934d97443c229a0c3ad5b697179e641" name="a9934d97443c229a0c3ad5b697179e641"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_MISO</b></td></tr>
<tr class="memitem:aacf6388dedb2b5bb6453a88f876f5ad9" id="r_aacf6388dedb2b5bb6453a88f876f5ad9"><td class="memItemLeft" align="right" valign="top"><a id="aacf6388dedb2b5bb6453a88f876f5ad9" name="aacf6388dedb2b5bb6453a88f876f5ad9"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_MOSI</b></td></tr>
<tr class="memitem:ac473cc8950e916a7621339a0576566ed" id="r_ac473cc8950e916a7621339a0576566ed"><td class="memItemLeft" align="right" valign="top"><a id="ac473cc8950e916a7621339a0576566ed" name="ac473cc8950e916a7621339a0576566ed"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_SCS</b></td></tr>
<tr class="memitem:af5afca17da30a42f6621efb5c70daabd" id="r_af5afca17da30a42f6621efb5c70daabd"><td class="memItemLeft" align="right" valign="top"><a id="af5afca17da30a42f6621efb5c70daabd" name="af5afca17da30a42f6621efb5c70daabd"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_EN</b></td></tr>
<tr class="memitem:ae969c2cfa71a5df4a38bce5c1c2b9cca" id="r_ae969c2cfa71a5df4a38bce5c1c2b9cca"><td class="memItemLeft" align="right" valign="top"><a id="ae969c2cfa71a5df4a38bce5c1c2b9cca" name="ae969c2cfa71a5df4a38bce5c1c2b9cca"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_CLKIN</b></td></tr>
<tr class="memitem:a9a4c1fc62fcaecb6846fa11eabf30dff" id="r_a9a4c1fc62fcaecb6846fa11eabf30dff"><td class="memItemLeft" align="right" valign="top"><a id="a9a4c1fc62fcaecb6846fa11eabf30dff" name="a9a4c1fc62fcaecb6846fa11eabf30dff"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_FGOUT</b></td></tr>
<tr class="memitem:a0d444c5f18e4866e0b42e4d5c7c6cf91" id="r_a0d444c5f18e4866e0b42e4d5c7c6cf91"><td class="memItemLeft" align="right" valign="top"><a id="a0d444c5f18e4866e0b42e4d5c7c6cf91" name="a0d444c5f18e4866e0b42e4d5c7c6cf91"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_FAULTn</b></td></tr>
<tr class="memitem:a2a2028f65ce54234754aa518da6e249f" id="r_a2a2028f65ce54234754aa518da6e249f"><td class="memItemLeft" align="right" valign="top"><a id="a2a2028f65ce54234754aa518da6e249f" name="a2a2028f65ce54234754aa518da6e249f"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_LOCKn</b></td></tr>
<tr class="memitem:af5fa5214ab98c0f4883a1572672794b5" id="r_af5fa5214ab98c0f4883a1572672794b5"><td class="memItemLeft" align="right" valign="top"><a id="af5fa5214ab98c0f4883a1572672794b5" name="af5fa5214ab98c0f4883a1572672794b5"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_RESET</b></td></tr>
<tr class="memitem:a49be2f974a6cdbe76b6b2112dbf6dbab" id="r_a49be2f974a6cdbe76b6b2112dbf6dbab"><td class="memItemLeft" align="right" valign="top"><a id="a49be2f974a6cdbe76b6b2112dbf6dbab" name="a49be2f974a6cdbe76b6b2112dbf6dbab"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_BRAKE</b></td></tr>
<tr class="memitem:a8ff2eba36ef0ee596d80d190c935517b" id="r_a8ff2eba36ef0ee596d80d190c935517b"><td class="memItemLeft" align="right" valign="top"><a id="a8ff2eba36ef0ee596d80d190c935517b" name="a8ff2eba36ef0ee596d80d190c935517b"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><b>PIN_DIR</b></td></tr>
<tr class="memitem:ad4c4a5e4d930da7295c42545c0947c20" id="r_ad4c4a5e4d930da7295c42545c0947c20"><td class="memItemLeft" align="right" valign="top"><a id="ad4c4a5e4d930da7295c42545c0947c20" name="ad4c4a5e4d930da7295c42545c0947c20"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>FILK1</b></td></tr>
<tr class="memitem:a390ed9f896aa11753df41e5a0781bd7c" id="r_a390ed9f896aa11753df41e5a0781bd7c"><td class="memItemLeft" align="right" valign="top"><a id="a390ed9f896aa11753df41e5a0781bd7c" name="a390ed9f896aa11753df41e5a0781bd7c"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>FILK2</b></td></tr>
<tr class="memitem:a829aedb9bdaabe5a85a0741598a812ca" id="r_a829aedb9bdaabe5a85a0741598a812ca"><td class="memItemLeft" align="right" valign="top"><a id="a829aedb9bdaabe5a85a0741598a812ca" name="a829aedb9bdaabe5a85a0741598a812ca"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>COMPK1</b></td></tr>
<tr class="memitem:abf1223c172e98ed0eca019c15f5d96fb" id="r_abf1223c172e98ed0eca019c15f5d96fb"><td class="memItemLeft" align="right" valign="top"><a id="abf1223c172e98ed0eca019c15f5d96fb" name="abf1223c172e98ed0eca019c15f5d96fb"></a>
uint16_t&#160;</td><td class="memItemRight" valign="bottom"><b>COMPK2</b></td></tr>
<tr class="memitem:a6470680a191c1179eca828e68be41a0b" id="r_a6470680a191c1179eca828e68be41a0b"><td class="memItemLeft" align="right" valign="top"><a id="a6470680a191c1179eca828e68be41a0b" name="a6470680a191c1179eca828e68be41a0b"></a>
volatile unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>_lastEdgeTime</b></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pro-static-attribs" class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a2d2ecdbb03579a2065231ba36dcb284d" id="r_a2d2ecdbb03579a2065231ba36dcb284d"><td class="memItemLeft" align="right" valign="top"><a id="a2d2ecdbb03579a2065231ba36dcb284d" name="a2d2ecdbb03579a2065231ba36dcb284d"></a>
static <a class="el" href="class_driver.html">Driver</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>_instance</b> = nullptr</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class is used to control the motor driver </p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af441586aaf1e40c53a08aecfda452224" name="af441586aaf1e40c53a08aecfda452224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af441586aaf1e40c53a08aecfda452224">&#9670;&#160;</a></span>Driver() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Driver::Driver </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for the <a class="el" href="class_driver.html">Driver</a> class. </p>
<p>Non-inline functions are commented in <a class="el" href="_driver_8cpp.html">Driver.cpp</a></p>
<p>This function initializes the DRV8308, setting each of the pins for the command and default gains tuned for mediocre performance at all speeds and during both idle and transient states. </p>

</div>
</div>
<a id="a65c3a4ff39eb08b1cd8e91e298bc3ddd" name="a65c3a4ff39eb08b1cd8e91e298bc3ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65c3a4ff39eb08b1cd8e91e298bc3ddd">&#9670;&#160;</a></span>Driver() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Driver::Driver </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>FILK1_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>FILK2_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>COMPK1_</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>COMPK2_</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for the <a class="el" href="class_driver.html">Driver</a> class. </p>
<p>This function initializes the DRV8308, setting each of the pins for the command setting custom gain coefficients. An accompanying MATLAB script is included to calculate these gain coefficients using equations detailed in the DRV8308 datasheet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FILK1_</td><td>setting the coefficient for the filter pole </td></tr>
    <tr><td class="paramname">FILK2_</td><td>setting the coefficient for the filter zero </td></tr>
    <tr><td class="paramname">COMPK1_</td><td>setting the coefficient for the compensator pole </td></tr>
    <tr><td class="paramname">COMPK2_</td><td>setting the coefficient for the compensator zero </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="aaf271624499126d5fe201d85b1685aeb" name="aaf271624499126d5fe201d85b1685aeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf271624499126d5fe201d85b1685aeb">&#9670;&#160;</a></span>begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::begin </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function which initializes the DRV8308. </p>
<p>This function sets each pin as an input or output, attaches an interrupt to FGOUT so it can read square wave rising edges, enables the DRV8308, unbrakes it from any previous operation, initializes the direction to be forward, begins SPI communication, writes initial gains to the DRV8308 chip, and sets up the CLKIN pin to output a square wave to output 50% duty cycle.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug</a></b></dt><dd>The <a class="el" href="#a85c6803836ce05696221267c55150676" title="A function which sets the brake pin to LOW.">unbrake()</a> does not actually work, sometimes you have to manually spin the motor before it starts taking commands again. </dd></dl>

</div>
</div>
<a id="a8dce7a48c374e73ca61327fd2d24bc3c" name="a8dce7a48c374e73ca61327fd2d24bc3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dce7a48c374e73ca61327fd2d24bc3c">&#9670;&#160;</a></span>brake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::brake </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the brake pin to HIGH. </p>
<p>The DRV8308 does not have a deceleration control loop, meaning that if a commanded speed is lower than the actual speed, if not commanded to brake, the motor will coast until it reaches the lower speed. The brake and unbrake commands are used in the state machine to prevent coasting. </p>

</div>
</div>
<a id="a9242027ce038a7794b3fa668550758b6" name="a9242027ce038a7794b3fa668550758b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9242027ce038a7794b3fa668550758b6">&#9670;&#160;</a></span>cmd_speed_PWM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::cmd_speed_PWM </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>SPEED_CMD</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function which commands a square wave to the CLKIN pin. </p>
<p>This function writes a square wave of 50% duty cycle to the CLKIN pin at the desired electrical frequency of the motor. From an equation on the DRV8308 datasheet, the electrical frequency is equal to RPM / 15.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SPEED_CMD</td><td>The desired rpm speed of the motor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a455b301fd7e229291c87dd3873e8b6ea" name="a455b301fd7e229291c87dd3873e8b6ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a455b301fd7e229291c87dd3873e8b6ea">&#9670;&#160;</a></span>disable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::disable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the enable pin to LOW. </p>
<p>Disabling the DRV8308 also sets all of its internal registers to zero. This occurs whenever the entire system is powered off, meaning that they have to be reprogrammed whenever the system is turned back on (which is why the <a class="el" href="#aaf271624499126d5fe201d85b1685aeb" title="A function which initializes the DRV8308.">begin()</a> method is called in the setup of <a class="el" href="main_8cpp.html">main.cpp</a>). </p>

</div>
</div>
<a id="a7d9a49ab333a9061275a4fd2d11767ea" name="a7d9a49ab333a9061275a4fd2d11767ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d9a49ab333a9061275a4fd2d11767ea">&#9670;&#160;</a></span>drv_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Driver::drv_read </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>addr7</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function which reads a register on the DRV8308. </p>
<p>This function takes an 8-bit address and uses SPI to read that register on the DRV8308. It returns the 16-bit value of that register. This was developed primarily to debug SPI communication and was kept because of its usefulness, and just in case the SPI demons decide to haunt us again. This code was written with the help of ChatGPT 5.1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr7</td><td>the 7-bit address register. The first bit is always one to signify a READ operation to the DRV8308 chip.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the 16 bit value of the register on the DRV8308. </dd></dl>

</div>
</div>
<a id="a17af9704f964721863b46977850ccd6a" name="a17af9704f964721863b46977850ccd6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17af9704f964721863b46977850ccd6a">&#9670;&#160;</a></span>drv_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::drv_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>addr7</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>message</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function which writes a register on the DRV8308. </p>
<p>This function takes an 8-bit address and a 16-bit message, and uses SPI to write a register on the DRV8308. This code was written with the help of ChatGPT 5.1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr7</td><td>the 7-bit address register. The first bit is always zero to signify a WRITE operation to the DRV8308 chip.</td></tr>
    <tr><td class="paramname">message</td><td>the 16-bit number that is being written to the DRV8308. Registers are defined on the DRV8308 datasheet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3ce3987ee4355a9b9e8a0aa7ee659874" name="a3ce3987ee4355a9b9e8a0aa7ee659874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce3987ee4355a9b9e8a0aa7ee659874">&#9670;&#160;</a></span>enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::enable </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the enable pin to HIGH. </p>
<p>This initializes the DRV8308. It does not run on EN LOW. </p>

</div>
</div>
<a id="a1f99f1d96fa20feee9311d46084725ff" name="a1f99f1d96fa20feee9311d46084725ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f99f1d96fa20feee9311d46084725ff">&#9670;&#160;</a></span>get_dir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Driver::get_dir </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which reads the direction. </p>
<p>This function reads the current polarity of the direction pin, which tells us whether the motor is spinning in the positive or negative direction. The convention defined for this project is polarity LO = positive direction and polarity HI = negative direction.</p>
<dl class="section return"><dt>Returns</dt><dd>The state of the direction pin. Logic for this is handled in the readActual task. </dd></dl>

</div>
</div>
<a id="a9424d9649c05cc33a61e74d4f7bc438a" name="a9424d9649c05cc33a61e74d4f7bc438a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9424d9649c05cc33a61e74d4f7bc438a">&#9670;&#160;</a></span>scs_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::scs_begin </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the chip select pin to HIGH. </p>
<p>The DRV8308 SPI communication works on CS HIGH. Calling this function begins a SPI transaction. </p>

</div>
</div>
<a id="a02225bf32d39bbb7deff11f11eeb2090" name="a02225bf32d39bbb7deff11f11eeb2090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02225bf32d39bbb7deff11f11eeb2090">&#9670;&#160;</a></span>scs_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::scs_end </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the chip select pin to LOW. </p>
<p>The DRV8308 SPI communication works on CS HIGH. Calling this function ends a SPI transaction. </p>

</div>
</div>
<a id="a7758fb8433f9eb70c246f3bd347a9a5f" name="a7758fb8433f9eb70c246f3bd347a9a5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7758fb8433f9eb70c246f3bd347a9a5f">&#9670;&#160;</a></span>set_dir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::set_dir </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>direction</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the direction. </p>
<p>This function is used in the state machine during zero crossings to reverse the direction of the motor by changing the polarity of the direction pin to the desired. In the future, it may be desired to automate this further by simply commanding the opposite polarity as opposed to a desired polarity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">direction</td><td>The desired direction polarity of the pin. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a85c6803836ce05696221267c55150676" name="a85c6803836ce05696221267c55150676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c6803836ce05696221267c55150676">&#9670;&#160;</a></span>unbrake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Driver::unbrake </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function which sets the brake pin to LOW. </p>
<p>This function is called whenever the DRV is decelerating and reaches the commanded deadband. While within brake, the DRV will not read any commanded PFM so it is necessary to unbrake before commanding a frequency. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_driver_8h_source.html">Driver.h</a></li>
<li><a class="el" href="_driver_8cpp.html">Driver.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="class_driver.html">Driver</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
